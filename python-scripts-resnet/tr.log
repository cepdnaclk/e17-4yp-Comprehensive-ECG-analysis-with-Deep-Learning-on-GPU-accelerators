GPU memory is free enough. Running Python script...
-------------pr---------------
/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/nn/modules/conv.py:309: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/Convolution.cpp:1003.)
  return F.conv1d(input, weight, bias, self.stride,
/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/nn/modules/loss.py:536: UserWarning: Using a target size (torch.Size([1])) that is different to the input size (torch.Size([])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.mse_loss(input, target, reduction=self.reduction)
0 tarainning loss : 1.4039438233997386 validation loss : inf Real validation loss : 1040.5894576362941
Validation loss decreased (inf --> inf).  Saving model ...
Traceback (most recent call last):
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/e17-4yp-Comprehensive-ECG-analysis-with-Deep-Learning-on-GPU-accelerators/python-scripts-resnet/Main_Transfer_Learning.py", line 83, in <module>
    resnet.train_and_validate(train_dataloader, validate_dataloader, validate_notscaled_dataloader, y_parameter)
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/e17-4yp-Comprehensive-ECG-analysis-with-Deep-Learning-on-GPU-accelerators/python-scripts-resnet/ConvolutionalResNet.py", line 87, in train_and_validate
    early_stopping(val_loss, self.model, y_parameter)
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/e17-4yp-Comprehensive-ECG-analysis-with-Deep-Learning-on-GPU-accelerators/python-scripts-resnet/earlystopping.py", line 35, in __call__
    self.save_checkpoint(val_loss, model, y_parameter+'_best_')
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/e17-4yp-Comprehensive-ECG-analysis-with-Deep-Learning-on-GPU-accelerators/python-scripts-resnet/earlystopping.py", line 50, in save_checkpoint
    torch.save(model.state_dict(), self.path+filename+'.pt')
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/serialization.py", line 440, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/serialization.py", line 315, in _open_zipfile_writer
    return container(name_or_buffer)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/serialization.py", line 288, in __init__
    super().__init__(torch._C.PyTorchFileWriter(str(name)))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: File checkpoints_V3/pr_best_.pt cannot be opened.
GPU memory is free enough. Running Python script...
-------------pr---------------
/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/nn/modules/conv.py:309: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/Convolution.cpp:1003.)
  return F.conv1d(input, weight, bias, self.stride,
torch.Size([64, 8, 5000])
torch.Size([64])
GPU memory is free enough. Running Python script...
-------------pr---------------
/storage/projects2/e17-4yp-compreh-ecg-analysis/minicondaInst/envs/test/lib/python3.11/site-packages/torch/nn/modules/conv.py:309: UserWarning: Using padding='same' with even kernel lengths and odd dilation may require a zero-padded copy of the input be created (Triggered internally at /opt/conda/conda-bld/pytorch_1682343970094/work/aten/src/ATen/native/Convolution.cpp:1003.)
  return F.conv1d(input, weight, bias, self.stride,
tensor([[[-0.0067, -0.0067, -0.0067,  ..., -0.0117, -0.0117, -0.0117],
         [-0.0017, -0.0017, -0.0017,  ...,  0.0000,  0.0000,  0.0000],
         [ 0.0175,  0.0175,  0.0175,  ..., -0.0017, -0.0017, -0.0017],
         ...,
         [-0.0083, -0.0083, -0.0083,  ..., -0.0233, -0.0233, -0.0233],
         [-0.0075, -0.0075, -0.0075,  ..., -0.0167, -0.0167, -0.0167],
         [-0.0042, -0.0042, -0.0042,  ...,  0.0000,  0.0000,  0.0000]],

        [[-0.0133, -0.0133, -0.0132,  ...,  0.0067,  0.0067,  0.0067],
         [-0.0075, -0.0075, -0.0075,  ...,  0.0233,  0.0233,  0.0233],
         [-0.0100, -0.0100, -0.0100,  ..., -0.0333, -0.0333, -0.0333],
         ...,
         [-0.0683, -0.0683, -0.0683,  ..., -0.0017, -0.0017, -0.0017],
         [-0.0183, -0.0183, -0.0183,  ..., -0.0083, -0.0083, -0.0083],
         [ 0.0483,  0.0483,  0.0483,  ..., -0.0133, -0.0133, -0.0133]],

        [[-0.0217, -0.0217, -0.0217,  ...,  0.1267,  0.1267,  0.1267],
         [-0.0033, -0.0033, -0.0033,  ...,  0.0325,  0.0325,  0.0325],
         [-0.0167, -0.0167, -0.0167,  ..., -0.1150, -0.1150, -0.1150],
         ...,
         [-0.0267, -0.0267, -0.0267,  ...,  0.2108,  0.2108,  0.2108],
         [ 0.0075,  0.0075,  0.0075,  ...,  0.1992,  0.1992,  0.1992],
         [ 0.0533,  0.0533,  0.0533,  ...,  0.1750,  0.1750,  0.1750]],

        ...,

        [[-0.0258, -0.0258, -0.0258,  ...,  0.0083,  0.0083,  0.0083],
         [-0.0008, -0.0008, -0.0008,  ...,  0.0100,  0.0100,  0.0100],
         [-0.0183, -0.0183, -0.0183,  ..., -0.0033, -0.0033, -0.0033],
         ...,
         [-0.0408, -0.0408, -0.0408,  ..., -0.0200, -0.0200, -0.0200],
         [-0.0425, -0.0425, -0.0425,  ..., -0.0175, -0.0175, -0.0175],
         [-0.0375, -0.0375, -0.0375,  ..., -0.0142, -0.0142, -0.0142]],

        [[ 0.0158,  0.0158,  0.0158,  ...,  0.0292,  0.0292,  0.0292],
         [-0.0258, -0.0258, -0.0258,  ...,  0.0383,  0.0383,  0.0383],
         [-0.0258, -0.0258, -0.0258,  ..., -0.0342, -0.0342, -0.0342],
         ...,
         [ 0.0233,  0.0233,  0.0233,  ..., -0.0408, -0.0408, -0.0408],
         [ 0.1192,  0.1192,  0.1192,  ..., -0.0767, -0.0767, -0.0767],
         [ 0.0225,  0.0225,  0.0225,  ..., -0.0133, -0.0133, -0.0133]],

        [[-0.0067, -0.0067, -0.0067,  ..., -0.0125, -0.0125, -0.0125],
         [-0.0017, -0.0017, -0.0017,  ..., -0.0067, -0.0067, -0.0067],
         [-0.0008, -0.0008, -0.0008,  ...,  0.0050,  0.0050,  0.0050],
         ...,
         [-0.0175, -0.0175, -0.0175,  ..., -0.0142, -0.0142, -0.0142],
         [-0.0108, -0.0108, -0.0108,  ..., -0.0092, -0.0092, -0.0092],
         [ 0.0083,  0.0083,  0.0083,  ..., -0.0233, -0.0233, -0.0233]]],
       device='cuda:0')
tensor([inf, inf, inf, inf, inf, inf, inf, inf], device='cuda:0')
tensor([0.3655, 0.3766, 0.1676, 0.4270, 0.3107, 0.2476, 0.4146, 0.3375],
       device='cuda:0')
tensor(inf, device='cuda:0')
GPU memory is free enough. Running Python script...
P_Area_I          -0.068
P_PeakTime_I       0.000
Q_Area_I           0.000
Q_PeakTime_I       0.000
R_Area_I           0.008
                   ...  
T_DurFull_aVF      0.000
P_Dur_Global      44.000
P_Found_Global     0.000
HR__Global        37.000
P_Term_V1          0.000
Length: 783, dtype: float64
P_Area_I            0.570
P_PeakTime_I      128.000
Q_Area_I            0.240
Q_PeakTime_I       26.000
R_Area_I            2.961
                   ...   
T_DurFull_aVF     294.000
P_Dur_Global      176.000
P_Found_Global      1.000
HR__Global        152.000
P_Term_V1          12.314
Length: 783, dtype: float64
GPU memory is free enough. Running Python script...
P_Area_I          -0.068
P_PeakTime_I       0.000
Q_Area_I           0.000
Q_PeakTime_I       0.000
R_Area_I           0.008
                   ...  
T_DurFull_aVF      0.000
P_Dur_Global      44.000
P_Found_Global     0.000
HR__Global        35.000
P_Term_V1          0.000
Length: 783, dtype: float64
P_Area_I            0.568
P_PeakTime_I      136.000
Q_Area_I            0.240
Q_PeakTime_I       28.000
R_Area_I            2.961
                   ...   
T_DurFull_aVF     288.000
P_Dur_Global      168.000
P_Found_Global      1.000
HR__Global        140.000
P_Term_V1          11.342
Length: 783, dtype: float64
GPU memory is free enough. Running Python script...
88.0
336.0
GPU memory is free enough. Running Python script...
88.0
354.0
Traceback (most recent call last):
  File "/storage/projects2/e17-4yp-compreh-ecg-analysis/e17-4yp-Comprehensive-ECG-analysis-with-Deep-Learning-on-GPU-accelerators/python-scripts-resnet/Main_Transfer_Learning.py", line 67, in <module>
    pr_min, qt_min, qrs_min = train_dataset.get_min_values()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'ECGDataSet_PTB_XL' object has no attribute 'get_min_values'
GPU memory is free enough. Running Python script...
88.0
336.0
88.0 0 0
336.0 0 0
GPU memory is free enough. Running Python script...
Before train
After train
88.0
336.0
88.0 0 0
336.0 0 0
GPU memory is free enough. Running Python script...
Before train
0       380.0
1       418.0
2       450.0
3       376.0
4       342.0
        ...  
6654    408.0
6655    372.0
6656    406.0
6657    424.0
6658    390.0
Name: QT_Int_Global, Length: 6659, dtype: float64
282.0
546.0
GPU memory is free enough. Running Python script...
./script.sh: line 24: 3712087 Killed                  python -u Main_Transfer_Learning.py
